name: Extract SafeNet iKey 2032 Driver

on:
  workflow_dispatch:

jobs:
  extract-driver:
    runs-on: windows-latest
    steps:
      - name: Checkout repo
        uses: actions/checkout@v4

      - name: Download SafeNet Authentication Client
        run: |
          curl -L -o safenet.zip "https://example.com/safenet_authentication_client.zip"
          tar -xf safenet.zip

      - name: Extract MSI contents
        run: |
          mkdir extracted
          msiexec /a "SafeNetAuthenticationClient.msi" /qb TARGETDIR="extracted"

      - name: Find driver files
        run: |
          mkdir driver_files
          Get-ChildItem -Path extracted -Recurse -Include *.inf,*.sys,*.cat | 
            Copy-Item -Destination driver_files

      - name: Upload driver files
        uses: actions/upload-artifact@v4
        with:
          name: safenet-driver-files
          path: driver_files
